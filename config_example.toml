# ======================================================
# Heliactyl Configuration File
# ======================================================

# ------------------------------------------------------
# General information
# ------------------------------------------------------
name = "Heliactyl"
icon = "../assets/favicon.png"
timezone = "Europe/Paris"

# ------------------------------------------------------
# Versioning / Platform Information
# ------------------------------------------------------
platform_codename = "Avalanche 2" 
version = "3.2.1-beta.1"

# ------------------------------------------------------
# General Settings
# ------------------------------------------------------
clusters = 2
database = "sqlite://storage/heliactyl.db"

# ------------------------------------------------------
# External Services
# ------------------------------------------------------
[pterodactyl]
domain = "https://panel.example.com"
key = "ptla_aa000aaaaaaaaaaaaaaaaaaaaa00aaaaaaaaaaa0aa0a"
client_key = "ptlc_aa000aaaaaaaaaaaaaaaaaaaaa00aaaaaaaaaaa0aa0a"
# For logs in ApplicationAPI.js
debug = false
# ------------------------------------------------------
# Pterodactyl Experimentation
# ------------------------------------------------------
# Your admin authentication data for server transfers system
# It could be found by inspecting your browser cookies when logged into the Pterodactyl admin panel
cookie_admin = "remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=...; XSRF-TOKEN=...; pterodactyl_session=..."
# It could be found by inspecting the network requests when transferring a server in the Pterodactyl admin panel
transfer_token = "6hUjLqcapcMj........."

[website]
port = 3000
secret = "random secret here"
domain = "https://example.com"
currency = "HCoins"
discord = "https://discord.gg/"
status = "https://status.example.com"
previewImage = "https://i.imgur.com/srXG82j.png"

# ------------------------------------------------------
# Cloudflare DNS Configuration
# ------------------------------------------------------
[cloudflare]
# Your Cloudflare API token with DNS edit permissions
api_token = "YOUR-CLOUDFLARE-API-TOKEN"

# List of domains for DNS management
# You can add as many domains as you need by copying this block
[[cloudflare.domains]]
name = "main"                              # Unique identifier for this domain
enabled = true                             # Set to false to disable this domain
domain = "your-main-domain.com"            # Domain name
zoneId = "your-main-domain-zone-id"       # Cloudflare Zone ID
is_default = true                          # Mark as default domain for new records

[[cloudflare.domains]]
name = "secondary"
enabled = true
domain = "your-secondary-domain.com"
zoneId = "your-secondary-domain-zone-id"
is_default = false

# Example of additional domain (copy and modify as needed)
[[cloudflare.domains]]
name = "another-domain"
enabled = false                            # Disabled by default
domain = "another-domain.com"
zoneId = "another-domain-zone-id"
is_default = false

# ======================================================
# API / Client Configuration
# ======================================================

# Module settings (formerly API)
[api.client]
# --- Client API ---
  [api.client.api]
  enabled = true
  code = "Example Code"

# --- Resend integration ---
  [api.client.resend]
  #enabled = false
  RESEND_API_KEY= ""
  RESEND_FROM_EMAIL= ""

# ---  Plesk integration ---
  [api.client.plesk]
  enabled = false
  PLESK_URL = "plesk.example.com"
  PLESK_USERNAME = "root"
  PLESK_PASSWORD = "password"
  SERVER_IP = "0.0.0.0"

# --- Join for Rewards (J4R) ---
  [api.client.j4r]
  enabled = true

    [[api.client.j4r.ads]]
    name = "Example server 1"
    invite = "https://discord.gg/example"
    id = "0000000000000000000"
    coins = 100

    [[api.client.j4r.ads]]
    name = "Example server 2"
    invite = "https://discord.gg/example"
    id = "0000000000000000000"
    coins = 200

    [[api.client.j4r.ads]]
    name = "Example server 3"
    invite = "https://discord.gg/example"
    id = "0000000000000000000"
    coins = 300

# --- Discord Bot ---
  [api.client.bot]
  token = "aaaaaaaaaaaaaaa0aaaaa0aaaaaa0.a0aaaa.aaaa_a0aaAaaAaaAaaaaAaAaAaA0aaA0aaaa"

    [api.client.bot.joinguild]
    _comment = "The Discord bot must be in these servers and have invite permissions. Automatic guild joining will not work unless role packages are configured correctly. You can always just set it to a random role & package so that only this works."
    enabled = false
    guildid = ["0000000000000000000"]

    [api.client.bot.giverole]
    _comment = "Auto-join must be enabled for this to work - or the user must already be in your Discord. This will give the user a role when they login."
    enabled = false
    guildid = "0000000000000000000"
    roleid = "0000000000000000000"

# --- Password Generator ---
  [api.client.passwordgenerator]
  signup = true
  note = "Use this to disable registering on Heliactyl."
  length = 24

# --- Permissions / Allow List ---
  [api.client.allow]
  new_users = true
  change_password = true
  over_resources_suspend = false
  anti_spam_detection = true # Enable anti-spam pattern detection on registration (blocks suspicious usernames/emails)

    [api.client.allow.server]
    create = true
    modify = true
    delete = true

# --- OAuth2 Configuration ---
# IMPORTANT: /api endpoint is required!
  [api.client.oauth2]
  _comment = "Go to https://discord.dev/ and create an application to set up OAuth2. This is required for Heliactyl to work. You must also set the redirect URL to the link below."
  id = "0000000000000000000"
  secret = "aaaaaaaaa0aa00aaaaaaaaaaaaaa0a_a"
  link = "https://example.com"
  callbackpath = "/api/auth/discord/callback" 
  prompt = true

    [api.client.oauth2.google]
    enable = false
    id = "0000000000000-0aa00a00aaa0a0aa0aaaaa000aaaaaa0.aaaa.aaaaaaaaaaaaaaaaa.aaa"
    secret = "aaaaaa-a0aaaaaa0a0aaaa0aaa0a0a_a0aa"
    link = "https://example.com"
    callbackpath = "/api/auth/google/callback"

    [api.client.oauth2.github]
    enable = false
    id = "aa00aaa0aAaaaaaaasaA"
    secret = "00aa00000a000000a0aada0000000000aa00000"
    link = "https://example.com"
    callbackpath = "/api/auth/github/callback"

    [api.client.oauth2.ip]
    "trust x-forwarded-for" = true
    block = [ ]
    "duplicate check" = true
    _note = "Anti-alt checks will not work if you are proxying through Cloudflare. This is due to the fact that Cloudflare does not pass the real IP address through the headers. If you are using Cloudflare, please disable this feature."

# --- Rate Limits ---
  [api.client.ratelimits]
  "/callback" = 2
  "/api/userinfo" = 1

# --- Packages ---
  [api.client.packages]
  default = "default"

    [api.client.packages.list.default]
    ram = 2_048
    disk = 3_072
    cpu = 100
    servers = 2

    [api.client.packages.list.2]
    ram = 6_144
    disk = 30_720
    cpu = 150
    servers = 8

    [api.client.packages.rolePackages]
    note = "This allows you to set a different plan/package to people who have a specific role however this requires the Discord bot to be configured and functioning. This is mainly used for Boost rewards."
    roleServer = "0000000000000000000"

      [api.client.packages.rolePackages.roles]
      "0000000000000000000" = "2"

# --- Locations ---
# To enable dynamic discovery, ensure your locations and nodes are correctly configured in Pterodactyl.
# The dashboard will automatically fetch nodes, slots, and disk capacity from the API.
# You can still override specific display names or flags here if needed.

# Example Location (ID: 1)
# Note: "capacity" and "nodes" are now optional/auto-discovered
[api.client.locations.1]
name = "France, FR"
short = "fr"
country = "France"
region = "eu-south"
flag = "https://cdn-icons-png.flaticon.com/512/197/197560.png"
cpu = "Ampere"

# --- Egg Templates ---
[api.client.eggs.velocity]
display = "Velocity"
category = "Game Servers" 
logo = "https://avatars.githubusercontent.com/u/41710604?s=200&v=4"
free = true

  [api.client.eggs.velocity.minimum]
  ram = 256
  disk = 256
  cpu = 50

  [api.client.eggs.velocity.maximum]
  ram = 4096
  disk = 10240
  cpu = 200

  [api.client.eggs.velocity.info]
  egg = 34
  docker_image = "ghcr.io/pterodactyl/yolks:java_21"
  startup = "java -Xms128M -Xmx{{SERVER_MEMORY}}M {{JAVA_ARGUMENTS}} -jar {{SERVER_JARFILE}}"

    [api.client.eggs.velocity.info.environment]
    SERVER_JARFILE = "server.jar"
    VELOCITY_VERSION = "latest"
    JAVA_ARGUMENTS = "-XX:+UseG1GC -XX:G1HeapRegionSize=4M -XX:+UnlockExperimentalVMOptions -XX:+ParallelRefProcEnabled -XX:+AlwaysPreTouch -XX:MaxInlineLevel=15"
    BUILD_NUMBER = "latest"

    [api.client.eggs.velocity.info.feature_limits]
    databases = 0
    backups = 0

[api.client.eggs.paper]
display = "Minecraft - Paper"
category = "Game Servers" 
logo = "https://avatars.githubusercontent.com/u/7608950?s=200&v=4"
free = true

  [api.client.eggs.paper.minimum]
  ram = 1024
  disk = 1024
  cpu = 100

  [api.client.eggs.paper.maximum]
  ram = 8192
  disk = 10240
  cpu = 200

  [api.client.eggs.paper.info]
  egg = 3
  docker_image = "ghcr.io/pterodactyl/yolks:java_21"
  startup = "java -Xms128M -Xmx{{SERVER_MEMORY}}M -Dterminal.jline=false -Dterminal.ansi=true -jar {{SERVER_JARFILE}}"

    [api.client.eggs.paper.info.environment]
    SERVER_JARFILE = "server.jar"
    BUILD_NUMBER = "latest"

    [api.client.eggs.paper.info.feature_limits]
    databases = 0
    backups = 0

[api.client.eggs.forge]
display = "Minecraft - Forge"
category = "Game Servers" 
logo = "https://avatars.githubusercontent.com/u/1390178?s=200&v=4"
free = true

  [api.client.eggs.forge.minimum]
  ram = 1024
  disk = 1024
  cpu = 100

  [api.client.eggs.forge.maximum]
  ram = 8192
  disk = 10240
  cpu = 200

  [api.client.eggs.forge.info]
  egg = 1
  docker_image = "ghcr.io/pterodactyl/yolks:java_21"
  startup = 'java -Xms128M -Xmx{{SERVER_MEMORY}}M -Dterminal.jline=false -Dterminal.ansi=true $( [[  ! -f unix_args.txt ]] && printf %s "-jar {{SERVER_JARFILE}}" || printf %s "@unix_args.txt" )'

    [api.client.eggs.forge.info.environment]
    SERVER_JARFILE = "server.jar"
    MC_VERSION = "latest"
    BUILD_TYPE = "recommended"

    [api.client.eggs.forge.info.feature_limits]
    databases = 0
    backups = 0

[api.client.eggs.nodejs]
display = "NodeJS"
category = "Generics" 
logo = "https://avatars.githubusercontent.com/u/9950313?s=200&v=4"
free = true

  [api.client.eggs.nodejs.minimum]
  ram = 512
  disk = 128
  cpu = 50

  [api.client.eggs.nodejs.maximum]
  ram = 8192
  disk = 10240
  cpu = 200

  [api.client.eggs.nodejs.info]
  egg = 47
  docker_image = "ghcr.io/parkervcp/yolks:nodejs_20"
  startup = 'if [[ -d .git ]] && [[ {{AUTO_UPDATE}} == "1" ]]; then git pull; fi; if [[ ! -z ${NODE_PACKAGES} ]]; then /usr/local/bin/npm install ${NODE_PACKAGES}; fi; if [[ ! -z ${UNNODE_PACKAGES} ]]; then /usr/local/bin/npm uninstall ${UNNODE_PACKAGES}; fi; if [ -f /home/container/package.json ]; then /usr/local/bin/npm install; fi; if [[ "${MAIN_FILE}" == "*.js" ]]; then /usr/local/bin/node "/home/container/${MAIN_FILE}" ${NODE_ARGS}; else /usr/local/bin/ts-node --esm "/home/container/${MAIN_FILE}" ${NODE_ARGS}; fi'

    [api.client.eggs.nodejs.info.environment]
    USER_UPLOAD = "0"
    GIT_ADDRESS = ""
    AUTO_UPDATE = "0"
    MAIN_FILE = "index.js"
    BRANCH = ""
    NODE_PACKAGES = ""
    USERNAME = ""
    ACCESS_TOKEN = ""
    UNNODE_PACKAGES = ""
    NODE_ARGS = ""

    [api.client.eggs.nodejs.info.feature_limits]
    databases = 0
    backups = 0
    
[api.client.eggs.python]
display = "Python Generic"
category = "Generics" 
logo = "https://avatars.githubusercontent.com/u/1525981?s=200&v=4"
free = true


  [api.client.eggs.python.minimum]
  ram = 512
  disk = 512
  cpu = 50

  [api.client.eggs.python.maximum]
    ram = 8192
  disk = 10240
  cpu = 200

  [api.client.eggs.python.info]
  egg = 53
  docker_image = "ghcr.io/parkervcp/yolks:python_3.12"
  startup = 'if [[ -d .git ]] && [[ "{{AUTO_UPDATE}}" == "1" ]]; then git pull; fi; if [[ ! -z "{{PY_PACKAGES}}" ]]; then pip install -U --prefix .local {{PY_PACKAGES}}; fi; if [[ -f /home/container/${REQUIREMENTS_FILE} ]]; then pip install -U --prefix .local -r ${REQUIREMENTS_FILE}; fi; /usr/local/bin/python /home/container/{{PY_FILE}}'

    [api.client.eggs.python.info.environment]
    GIT_ADDRESS = ""
    BRANCH = ""
    USER_UPLOAD = "0"
    AUTO_UPDATE = "0"
    PY_FILE = "app.py"
    PY_PACKAGES = ""
    USERNAME = ""
    ACCESS_TOKEN = ""
    REQUIREMENTS_FILE = "requirements.txt"

    [api.client.eggs.python.info.feature_limits]
    databases = 0
    backups = 0

# --- Coins / Store ---
  [api.client.coins]
  enabled = true

  [api.client.coins.daily]
  enabled = true
  amount = 150
  per = "day"

  [api.client.coins.referral]
  enabled = true
  owner = 80
  referee = 250

    [api.client.coins.store]
    enabled = true

      [api.client.coins.store.renewalbypass]
      enabled = true
      cost = 3500

      [api.client.coins.store.ram]
      cost = 600
      per = 1_024
      limit = 16 # limit * per = limit total RAM in MB

      [api.client.coins.store.disk]
      cost = 200
      per = 5_120
      limit = 100 # limit * per = limit total disk in MB

      [api.client.coins.store.cpu]
      cost = 500
      per = 100
      limit = 8 # limit * per = limit total CPU in %

      [api.client.coins.store.servers]
      cost = 200
      per = 1
      limit = 10

# ======================================================
# Secondary Modules
# ======================================================

[api.afk]
enabled = true
path = "ws"
every = 60                    # Seconds between rewards (60 = 1 minute)
coins = 1                     # Base coins per reward interval
state_update_interval = 1000  # Milliseconds between state updates to clients
_note = "This is the 2nd-generation version of Heliactyl's AFK system with Party Boost."

  # Party Boost - Multiply rewards when multiple users are AFK simultaneously
  [api.afk.party_boost]
  enabled = true
  # Multiplier thresholds: [[min_users, multiplier], ...]
  # When X users are AFK, everyone gets Y times the rewards
  thresholds = [
    [3.0, 1.1],     # 3+ users = 1.1x (10% bonus)
    [5.0, 1.25],    # 5+ users = 1.25x (25% bonus)
    [10.0, 1.5],    # 10+ users = 1.5x (50% bonus)
    [15.0, 1.75],   # 15+ users = 1.75x (75% bonus)
    [20.0, 2.0],    # 20+ users = 2.0x (100% bonus)
    [30.0, 2.5],    # 30+ users = 2.5x (150% bonus)
    [50.0, 3.0],    # 50+ users = 3.0x (200% bonus)
  ]
  min_multiplier = 1.0        # Minimum multiplier (when alone)
  max_multiplier = 5.0        # Maximum multiplier cap (safety limit)

[whitelist]
status = false
users = [ "User ID" ]
note = "This allows only specific people to be able to login to the Heliactyl dashboard. This does not affect your Panel."

[security]
enableCaptcha = false
recaptchaSiteKey = "0aa0aaaaaaaaaaaaaaa0aaaaaaaaaaaaaa0aaa0aa"
recaptchaServerKey = "0aa0aaaaaaaaaaaaaaa0aaaaaaaaaaaaaa0aaa0aa"

[sftp] # Mode: "node" uses SFTP details from the API (data.attributes.sftp_details.ip), "allocation" uses the allocation IP (useful if your node is behind a proxy)
mode = "node"

[advent]
enabled = true
# Custom rewards for the special rewards (1% chance)
# You need to do the verification of the rewards manually (like screenshots of the rewards)
 [advent.customRewards]
  enabled = true
  rewards = [
      "discord_role",
      "premium_plan_1month",
      "steam_gift_card_10"
  ]

# ------------------------------------------------------
# Renewal Settings
# ------------------------------------------------------
[renewal]
renewal_period = 48          # Hours before server needs renewal
warning_threshold = 24       # Hours before expiration to show warning
check_interval = 5           # Minutes between expiration checks
auto_delete_enabled = false  # Enable automatic server deletion after expiration
auto_delete_after = 24       # Hours after expiration before server is deleted

# ------------------------------------------------------
# Update Configuration
# ------------------------------------------------------
[update]
enabled = true              # Enable or disable the update checker
checkReleases = true       # Check for new releases
checkPreReleases = true    # Check for pre-releases
checkCommits = false       # Check for new commits (development updates)
autoInstall = false        # Automatically install updates
checkInterval = 3600000    # Check interval in milliseconds (default: 1 hour)
 
# ======================================================
# Logging System
# ======================================================
[logging]
status = false
public = "https://aaaaaaa.aaa/aaa/aaaaaaaa/0000000000000000000/aaa0aa0aa-00aaAaaA-aaaaaaaaa0aaa0aAa0aa0aa0aa0a0"
private = "https://aaaaaaa.aaa/aaa/aaaaaaaa/0000000000000000000/aaa0aa0aa-00aaAaaA-aaaaaaaaa0aaa0aAa0aa0aa0aa0a0"

  [logging.actions.user]
  # Account
  "sign up" = true
  "sign in" = true
  "profile update" = true
  # Account deletion
  "account deletion" = true
  # Server
  "created server" = true
  "modified server" = true
  "deleted server" = true
  "resource adjustment" = true
  # Store
  "buy servers" = true  
  "buy ram" = true
  "buy cpu" = true
  "buy disk" = true
  "transaction" = true
  "renewal bypass" = true
  # Rewards
  "gifted coins" = true
  "daily coins" = true
  "advent calendar" = true
  # Security
  "anti-alt" = true
  # Events
  "halloween rewards claimed" = true

  [logging.actions.admin]
  # Coins management
  "set coins" = true
  "add coins" = true
  # Resources management
  "set resources" = true
  "add resources" = true
  # Plan management
  "set plan" = true
  # Account management
  "remove account" = true
  # Ban system
  "unban user" = true
  "ban user" = true

  [logging.actions.api]
  # Access & Errors
  "api access" = true
  "api error" = true
  # Coins management
  "api set coins" = true
  "api add coins" = true
  # Plan management
  "api set plan" = true
  # Resources management
  "api set resources" = true
  # Ban system
  "api ban user" = true
  "api unban user" = true